{% load static %} {% include "includes/header.html" %}
<style>
    .message {
        padding: 10px;
        margin: 10px;
        border-radius: 5px;
        word-wrap: break-word;
    }

    .message.received {
        background-color: #f0f0f0;
        text-align: left;
    }

    .message.sent {
        background-color: #007bff;
        color: #fff;
        text-align: right;
    }

    .profile-picture {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        margin-right: 10px;
    }
</style>

{% include "SubProject/list-projectTeamContent.html" %}

                <div class="card">
                    <div class="card-body">
                        {% for chat in Project_team.chats %}
                        {% if request.user == chat.sender.user %}
                        <div class="message sent">
                            {{chat.message}}
                        </div>
                        {% else %}
                        <div class="message received">
                            <img src="{% static 'static/logo.svg' %}" alt="Receiver Profile" class="profile-picture">
                            {{chat.message}}
                        </div>
                        {% endif %}
                        {% endfor %}
                    </div>
                    <div class="card-footer">
                        <form enctype="multipart/form-data" method="POST">
                        {% csrf_token %}
                            <div class="input-group">
                            <input type="text" class="form-control" name="message" placeholder="Type a message">
                            <div class="input-group-append">
                                <input class="btn btn-primary" type="submit" value="Send">
                            </div>
                            
                        </div>
                        </form>
                </div>
            </div>

    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
  
    <script src="{% static 'assets/vendor/apexcharts/apexcharts.min.js' %}"></script>
    <script src="{% static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'assets/vendor/chart.js/chart.umd.js' %}"></script>
    <script src="{% static 'assets/vendor/echarts/echarts.min.js' %}"></script>
    <script src="{% static 'assets/vendor/quill/quill.min.js' %}"></script>
    <script src="{% static 'assets/vendor/simple-datatables/simple-datatables.js' %}"></script>
    <script src="{% static 'assets/vendor/tinymce/tinymce.min.js' %}"></script>
    <script src="{% static 'assets/vendor/php-email-form/validate.js' %}"></script>
  
    <!-- Template Main JS File -->
    <script src="{% static 'assets/js/main.js' %}"></script>
  
    <script>
        let submitButton = document.getElementById('saving')
        let inputMessage = document.querySelector('.quill-editor-full')
        submitButton.addEventListener('click', function(event){
            event.preventDefault();
            let contentReturned = inputMessage.querySelector('.ql-editor').children
            const domain = document.URL.split(':')
            const contenturl =  domain[0] + ':' + domain[1] + ':' + domain[2].split('/')[0]+'/comunicationList'
            
            fetch(contenturl, {
              'method': 'POST',
            'body':contentReturned,
            'headers':{
              'Content-Type':'application/json'
            }
          });
        });
    </script>
  </body>
  
  </html>